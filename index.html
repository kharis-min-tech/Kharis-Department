<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kharis Department Quiz - Multilingual</title>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; transition: all .25s ease; }
    html, body { height: 100%; margin: 0; }
    
    body {
      font-family: 'Quicksand', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 2rem;
      --bg-img: url('https://kharis.org/wp-content/uploads/2022/11/271239127_4868436629869265_1030465267411614205_n.jpg');
      --card-bg: rgba(60,19,97,0.85);
      --btn-bg: #ffd700;
      --btn-color: #3c1361;
      --text-color: #fff;
      background: var(--bg-img) center/cover no-repeat fixed;
      color: var(--text-color);
    }
    
    body.light {
      --card-bg: rgba(255,255,255,0.95);
      --btn-bg: #3c1361;
      --btn-color: #ffd700;
      --text-color: #111;
      background: linear-gradient(180deg,#fff,#f4f4f4);
    }
    
    .card {
      width: 100%;
      max-width: 820px;
      background: var(--card-bg);
      border-radius: 18px;
      padding: 2rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      color: var(--text-color);
      position: relative;
    }
    
    h1 { font-family: 'Fredoka One', cursive; margin-bottom: 0.6rem; }
    p.lead { margin-bottom: 1rem; opacity: 0.9; }
    
    .btn {
      display: inline-block;
      width: 100%;
      max-width: 360px;
      margin: 0.6rem auto;
      padding: 12px 18px;
      border-radius: 50px;
      border: none;
      background: var(--btn-bg);
      color: var(--btn-color);
      font-family: 'Fredoka One', cursive;
      cursor: pointer;
      font-size: 1rem;
    }
    
    .btn:hover { filter: brightness(.92); transform: scale(1.02); }
    
    input[type="text"], select {
      width: 100%;
      padding: 12px 14px;
      border-radius: 30px;
      border: none;
      font-size: 1rem;
      margin-bottom: 12px;
      background: rgba(255,255,255,0.9);
      color: #3c1361;
      text-align: center;
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.15);
    }
    
    /* Bubbly Dropdown Styles */
    .language-dropdown-container {
      position: relative;
      display: inline-block;
      margin: 0 auto 20px auto;
      text-align: center;
      z-index: 1000;
    }
    
    .language-select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 215, 0, 0.7);
      border-radius: 25px;
      padding: 12px 45px 12px 20px;
      font-size: 16px;
      font-weight: bold;
      color: #fff;
      cursor: pointer;
      width: 200px;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      outline: none;
    }
    
    .language-select:hover {
      background: rgba(255, 255, 255, 0.3);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }
    
    .language-select:focus {
      box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.5);
    }
    
    .language-dropdown-container::after {
      content: "‚ñº";
      font-size: 12px;
      color: #ffd700;
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
    }
    
    .language-select option {
      background: rgba(60, 19, 97, 0.95);
      color: #fff;
      padding: 10px;
      border-radius: 15px;
      margin: 5px;
      font-weight: bold;
    }
    
    .language-select::-webkit-scrollbar {
      width: 8px;
    }
    
    .language-select::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }
    
    .language-select::-webkit-scrollbar-thumb {
      background: rgba(255, 215, 0, 0.7);
      border-radius: 10px;
    }
    
    .language-select::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 215, 0, 0.9);
    }
    
    /* Quiz specific styles */
    #quiz, #result { 
      opacity: 0; 
      transition: opacity 0.5s ease; 
      display: none;
    }
    #quiz.show, #result.show { 
      opacity: 1; 
      display: block;
    }
    
    .question-counter {
      text-align: center;
      font-weight: 600;
      margin-bottom: 8px;
      opacity: 0.9;
    }
    
    .question { font-family: 'Fredoka One', cursive; font-size: 1.15rem; margin: 10px 0; }
    .scripture { font-style: italic; opacity: 0.85; margin-bottom: 8px; }
    
    .progress-bar { width: 100%; height: 12px; background: #ddd; border-radius: 999px; overflow: hidden; margin: 14px 0; }
    .progress { height: 100%; width: 0%; background: var(--btn-bg); transition: width .35s ease; }
    
    .result { margin-top: 12px; }
    .department { margin: 10px 0; font-family: 'Fredoka One', cursive; font-size: 1.08rem; opacity: 0; transform: translateY(10px); transition: all .6s ease; }
    .department.show { opacity: 1; transform: none; }
    
    .scripture-box {
      margin-top: 8px;
      padding: 12px;
      border-left: 5px solid var(--btn-bg);
      background: rgba(255,215,0,0.08);
      border-radius: 8px;
      text-align: left;
      font-style: italic;
      display: none;
    }
    
    .scripture-box.visible { display: block; }
    
    .toggle-mode {
      position: absolute;
      top: 16px;
      right: 16px;
      background: transparent;
      border: 2px solid var(--btn-bg);
      color: var(--btn-bg);
      padding: 6px 10px;
      border-radius: 18px;
      cursor: pointer;
    }
    
    .back-btn {
      background: transparent;
      color: var(--btn-bg);
      border: 2px solid var(--btn-bg);
      padding: 8px 14px;
      border-radius: 28px;
      cursor: pointer;
      font-family: 'Fredoka One', cursive;
      display: inline-block;
    }
    
    /* Explore list styles */
    .explore-list { margin-top: 12px; display: flex; flex-direction: column; gap: 8px; }
    .explore-item {
      background: rgba(255,255,255,0.06);
      padding: 12px 14px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      font-weight: 700;
    }
    .explore-item .title { flex: 1; text-align: left; font-weight: 700; }
    .explore-details { display: none; padding: 10px 12px; margin-top: 8px; background: rgba(0,0,0,0.15); border-radius: 6px; text-align: left; font-style: normal; color: var(--text-color); }
    .explore-details.visible { display: block; }
    
    /* Background slideshow */
    .bg-slideshow {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }
    
    .bg-slide {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 1s ease-in-out;
      background-size: cover;
      background-position: center;
    }
    
    .bg-slide.active {
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="pageTitle">
    <button class="toggle-mode" id="modeBtn" aria-label="Toggle light/dark">üåô</button>

    <!-- LOGO HERE -->
    <div class="logo-center">
      <img src="https://kharis.org/wp-content/uploads/2022/08/Logo_transparent_noText.png" 
           alt="Kharis Church Logo" 
           style="max-width:80px; display:block; margin:0 auto 16px auto;">
    </div>

    <h1 id="pageTitle">Discover Your Kharis Department</h1>
    <p class="lead center" id="pageSubtitle">Answer a few short questions to see where your gifting fits best.</p>

    <!-- Bubbly Language Dropdown -->
    <div class="language-dropdown-container">
      <select id="languageSelect" class="language-select" aria-label="Select Language">
        <option value="en" selected>English üá¨üáß</option>
        <option value="fr">Fran√ßais üá´üá∑</option>
        <option value="es">Espa√±ol üá™üá∏</option>
        <option value="de">Deutsch üá©üá™</option>
        <option value="tw">Twi (Ghana) üá¨üá≠</option>
        <option value="sv">Svenska üá∏üá™</option>
        <option value="gd">G√†idhlig (Scottish) üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø</option>
      </select>
    </div>

    <!-- Start Screen -->
    <div id="start-screen">
      <input id="username" type="text" placeholder="Enter your Fullname" />
      <select id="branch" aria-label="Select branch">
        <option value="" disabled selected>Select your branch</option>
        <option>Kharis Church Accra</option>
        <option>Kharis Church Birmingham</option>
        <option>Kharis Church Brighton</option>
        <option>Kharis Church Bristol</option>
        <option>Kharis Church Chatham</option>
        <option>Kharis Church Chelmsford</option>
        <option>Kharis Church Coventry</option>
        <option>Kharis Church Croydon</option>
        <option>Kharis Church Freetown</option>
        <option>Kharis Church London</option>
        <option>Kharis Church Luton</option>
        <option>Kharis Church Manchester</option>
        <option>Kharis Church Northampton</option>
        <option>Kharis Church Nottingham</option>
        <option>Kharis Church Orpington</option>
        <option>Kharis Church Reading</option>
        <option>Kharis Phase 2 Birmingham</option>
        <option>Kharis Phase 2 London</option>
        <option>Kharis Phase 2 Romford</option>
        <option>Kharis Phase 2 Southampton</option>
      </select>
      <button class="btn" id="start-kharis">Start Quiz</button>
    </div>

    <!-- Quiz -->
    <div id="quiz"></div>

    <div class="progress-bar" aria-hidden="true"><div class="progress" id="progress"></div></div>

    <div style="text-align:center;">
      <button class="back-btn" id="back-btn" style="display:none;">‚Üê Back</button>
    </div>

    <!-- Result -->
    <div id="result"></div>

    <!-- Background Slideshow -->
    <div class="bg-slideshow" id="bgSlideshow"></div>
  </div>

  <script>
  (function(){
    // Background images for slideshow
    const bgImages = [
      'https://kharis.org/wp-content/uploads/2022/10/PHOTO-2022-10-11-00-55-32-Copy-2.jpg',
      'https://kharis.org/wp-content/uploads/2022/11/260807749_4700323106680619_8475937483849630905_n.jpg',
      'https://kharis.org/wp-content/uploads/2024/06/IMG-20240615-WA0032.jpg',
      'https://kharis.org/wp-content/uploads/2022/10/PHOTO-2022-10-13-12-43-46.jpg',
      'https://kharis.org/wp-content/uploads/2022/10/PHOTO-2022-10-13-12-43-59.jpg',
      'https://kharis.org/wp-content/uploads/2022/10/PHOTO-2022-10-13-12-43-50.jpg',
      'https://store.khar.is/cdn/shop/files/67200988_2450803551632597_4416726294536912896_n_142db4d4-d790-4773-9f17-1714e2b327a4.jpg?v=1626368354',
      'https://kharis.org/wp-content/uploads/2022/10/PHOTO-2022-09-30-17-34-12-Copy-2.jpg',
      'https://kharis.org/wp-content/uploads/2022/10/PHOTO-2022-09-30-17-34-12-Copy.jpg',
      'https://kharis.org/wp-content/uploads/2022/10/PHOTO-2022-09-30-17-33-42-Copy-10.jpg',
      'https://kharis.org/wp-content/uploads/2024/06/IMG-20240615-WA0036.jpg',
      'https://kharis.org/wp-content/uploads/2023/10/IMG_5389-scaled.jpeg',
      'https://kharis.org/wp-content/uploads/2022/10/PHOTO-2022-09-30-17-33-41-Copy-2.jpg',
      'https://kharis.org/wp-content/uploads/2024/06/IMG-20240615-WA0033.jpg',
      'https://kharis.org/wp-content/uploads/2024/05/601A6563-scaled.jpg',
      'https://kharis.org/wp-content/uploads/2023/10/PHOTO-2023-10-18-15-59-596.jpg',
      'https://kharis.org/wp-content/uploads/2024/05/601A9547-scaled.jpg',
    ];

    // Initialize background slideshow
    function initSlideshow() {
      const slideshow = document.getElementById('bgSlideshow');
      
      // Create slide elements
      bgImages.forEach((img, index) => {
        const slide = document.createElement('div');
        slide.className = 'bg-slide';
        slide.style.backgroundImage = `url('${img}')`;
        if (index === 0) slide.classList.add('active');
        slideshow.appendChild(slide);
      });
      
      // Start slideshow
      let currentSlide = 0;
      const slides = document.querySelectorAll('.bg-slide');
      
      setInterval(() => {
        slides[currentSlide].classList.remove('active');
        currentSlide = (currentSlide + 1) % slides.length;
        slides[currentSlide].classList.add('active');
      }, 5000);
    }
const SHEET_URL = "https://script.google.com/macros/s/AKfycbxz0F4EoHusuSJ_e04shOtOrg9Hh8ijkSwgYQBE81yS7vD7p-6kUoOwj9P_mD5UcYNh/exec"; // replace if needed

    // Language translations
    const translations = {
      en: {
        title: "Discover Your Kharis Department",
        subtitle: "Answer a few short questions to see where your gifting fits best.",
        namePlaceholder: "Enter your Fullname",
        branchPlaceholder: "Select your branch",
        startButton: "Start Quiz",
        questionCounter: "Question {current} of {total}",
        nextButton: "Next",
        backButton: "‚Üê Back",
        resultsTitle: "{name} ({branch}) ‚Äî Your Top Departments",
        exploreButton: "Explore All Departments",
        restartButton: "Start Over",
        allDepartments: "All Departments",
        backToResults: "Back to Results",
        errorMsg: "Please type something so we can figure this out üòä",
        noResults: "No department scores were recorded ‚Äî but don't worry. Try again and add a few keywords in your answers (e.g., \"I love to sing\", \"I like planning events\").",
        // Quiz questions
        questions: [
          { q: "When faced with chaos, what grounds you most?", s: "1 Corinthians 14:33 ‚Äì For God is not a God of disorder but of peace." },
          { q: "How do you prefer to impact others?", s: "Matthew 5:16 ‚Äì Let your light shine before others." },
          { q: "In a group, you are the one who...", s: "Romans 12:6 ‚Äì We have different gifts, according to the grace given to each of us." },
          { q: "Which part of a service do you naturally notice first?", s: "Ephesians 6:7 ‚Äì Serve wholeheartedly, as if you were serving the Lord." },
          { q: "If you could lead something, what would it be?", s: "Joshua 1:9 ‚Äì Be strong and courageous." },
          { q: "When someone is hurting, what do you naturally do?", s: "2 Corinthians 1:4 ‚Äì God comforts us‚Ä¶ so we can comfort others." },
          { q: "What excites you most: creating, organising, helping, or sharing boldly?", s: "Colossians 3:23 ‚Äì Whatever you do, work at it with all your heart." },
          { q: "If you had one talent to use for God, what would it be?", s: "1 Peter 4:10 ‚Äì Each of you should use whatever gift you have received to serve others." }
        ],
        // Department data
        departments: {
          "Administration": { desc: "Organised, detail-oriented, and dependable individuals who excel at planning, coordinating, and ensuring smooth operations.", scripture: "1 Corinthians 14:40 - 'But everything should be done in a fitting and orderly way.'" },
          "Children's Department": { desc: "Patient, nurturing, and joyful people who love teaching, encouraging, and inspiring children to grow in faith.", scripture: "Matthew 19:14 - 'Let the little children come to me, and do not hinder them, for the kingdom of heaven belongs to such as these.'" },
          "Design": { desc: "Innovative and artistic individuals who bring ideas to life visually, using creativity to communicate messages with excellence.", scripture: "Exodus 35:35 - 'He has filled them with skill to do all kinds of work as engravers, designers, embroiderers... and weavers.'" },
          "Drama": { desc: "Expressive, imaginative, and bold individuals who use storytelling and performance to communicate the gospel in powerful ways.", scripture: "Matthew 13:34 - 'Jesus spoke all these things to the crowd in parables; he did not say anything to them without using a parable.'" },
          "Hospitality": { desc: "Warm, welcoming, and caring people who create an atmosphere of love and comfort for everyone they serve.", scripture: "1 Peter 4:9 - 'Offer hospitality to one another without grumbling.'" },
          "Host Team": { desc: "Friendly, approachable, and service-minded individuals who make everyone feel seen, valued, and at home.", scripture: "Romans 15:7 - 'Therefore welcome one another as Christ has welcomed you, for the glory of God.'" },
          "Production": { desc: "Diligent and detail-oriented individuals who ensure the smooth running of services through technical excellence and behind-the-scenes support.", scripture: "Colossians 3:23 - 'Whatever you do, work at it with all your heart, as working for the Lord, not for human masters.'" },
          "Music": { desc: "Passionate, skilled, and Spirit-filled individuals who use their gifts to lead others into worship and the presence of God.", scripture: "Psalm 95:1-2 - 'Come, let us sing for joy to the Lord; let us shout aloud to the Rock of our salvation. Let us come before him with thanksgiving and extol him with music and song.'" },
          "Follow Up": { desc: "Caring, attentive, and relational individuals who enjoy guiding new believers, building trust, and encouraging spiritual growth.", scripture: "Matthew 28:19 - 'Therefore go and make disciples of all nations, baptizing them in the name of the Father and of the Son and of the Holy Spirit.'" },
          "New Believers": { desc: "Patient, supportive, and mentoring-minded people who love helping others understand faith and grow spiritually.", scripture: "Colossians 1:28 - 'He is the one we proclaim, admonishing and teaching everyone with all wisdom, so that we may present everyone fully mature in Christ.'" },
          "Evangelism": { desc: "Bold, outgoing, and confident individuals who love sharing the gospel and engaging others with compassion and courage.", scripture: "Mark 16:15 - 'He said to them, \"Go into all the world and preach the gospel to all creation.\"'" },
          "Sanctuary Keepers": { desc: "Responsible, conscientious, and detail-focused people who take pride in maintaining a clean and orderly worship environment.", scripture: "1 Corinthians 3:16 - 'Don't you know that you yourselves are God's temple and that God's Spirit dwells in your midst?'" },
          "Set-up": { desc: "Hands-on, practical, and solution-oriented individuals who enjoy preparing spaces, managing logistics, and problem-solving.", scripture: "Nehemiah 4:6 - 'So we rebuilt the wall till all of it reached half its height, for the people worked with all their heart.'" },
          "Social Media": { desc: "Creative, tech-savvy, and communicative personalities who enjoy storytelling and engaging communities online.", scripture: "Psalm 19:14 - 'May these words of my mouth and this meditation of my heart be pleasing in your sight, Lord, my Rock and my Redeemer.'" },
          "Sound": { desc: "Technically-minded, attentive, and precise individuals who thrive on managing audio and creating seamless sound experiences.", scripture: "1 Corinthians 14:7 - 'If even lifeless instruments give sounds, how will anyone know what is played?'" },
          "Uniform": { desc: "Meticulous, disciplined, and detail-oriented people who value presentation, consistency, and high standards.", scripture: "1 Timothy 4:12 - 'Don't let anyone look down on you because you are young, but set an example for the believers in speech, in conduct, in love, in faith and in purity.'" },
          "Ushers": { desc: "Friendly, approachable, and service-minded individuals who enjoy guiding, assisting, and caring for people in practical ways.", scripture: "Hebrews 13:17 - 'Have confidence in your leaders and submit to their authority, because they keep watch over you as those who must give an account.'" },
          "Welfare": { desc: "Compassionate, empathetic, and generous-hearted people who are motivated to help those in need and provide support.", scripture: "Galatians 6:2 - 'Carry each other's burdens, and in this way you will fulfill the law of Christ.'" },
          "Security": { desc: "Alert, responsible, and protective individuals who prioritise safety and ensure a secure environment for others.", scripture: "Proverbs 27:12 - 'The prudent see danger and take refuge, but the simple keep going and pay the penalty.'" },
          "Media": { desc: "Creative and tech-savvy individuals who capture, design, and share content that spreads the message with clarity and excellence, making the vision visible to all.", scripture: "Habakkuk 2:2 - 'Write the vision; make it plain on tablets, so he may run who reads it.'" },
          "Spoken Word": { desc: "Expressive and creative individuals who use poetry, spoken word, or performance art to inspire and communicate the gospel with emotion and impact.", scripture: "Psalm 19:14 - 'May the words of my mouth and the meditation of my heart be pleasing in your sight, O Lord.'" }
        }
      },
      fr: {
        title: "D√©couvrez Votre D√©partement Kharis",
        subtitle: "R√©pondez √† quelques questions pour voir o√π vos dons s'int√®grent le mieux.",
        namePlaceholder: "Entrez votre nom complet",
        branchPlaceholder: "S√©lectionnez votre branche",
        startButton: "Commencer le Quiz",
        questionCounter: "Question {current} sur {total}",
        nextButton: "Suivant",
        backButton: "‚Üê Retour",
        resultsTitle: "{name} ({branch}) ‚Äî Vos D√©partements Principaux",
        exploreButton: "Explorer Tous les D√©partements",
        restartButton: "Recommencer",
        allDepartments: "Tous les D√©partements",
        backToResults: "Retour aux R√©sultats",
        errorMsg: "Veuillez taper quelque chose pour que nous puissions comprendre üòä",
        noResults: "Aucun score de d√©partement n'a √©t√© enregistr√© - mais ne vous inqui√©tez pas. R√©essayez et ajoutez quelques mots-cl√©s dans vos r√©ponses (par exemple, \"J'aime chanter\", \"J'aime organiser des √©v√©nements\").",
        questions: [
          { q: "Face au chaos, qu'est-ce qui vous ancre le plus?", s: "1 Corinthiens 14:33 - Car Dieu n'est pas un Dieu de d√©sordre, mais de paix." },
          { q: "Comment pr√©f√©rez-vous avoir un impact sur les autres?", s: "Matthieu 5:16 - Que votre lumi√®re luise ainsi devant les hommes." },
          { q: "Dans un groupe, vous √™tes celui qui...", s: "Romains 12:6 - Nous avons des dons diff√©rents, selon la gr√¢ce qui nous a √©t√© accord√©e." },
          { q: "Quelle partie d'un service remarquez-vous naturellement en premier?", s: "√âph√©siens 6:7 - Servez de bon c≈ìur, comme pour le Seigneur." },
          { q: "Si vous pouviez diriger quelque chose, ce serait quoi?", s: "Josu√© 1:9 - Fortifie-toi et prends courage." },
          { q: "Quand quelqu'un souffre, que faites-vous naturellement?", s: "2 Corinthiens 1:4 - Dieu nous console... afin que nous puissions consoler les autres." },
          { q: "Qu'est-ce qui vous passionne le plus : cr√©er, organiser, aider ou partager hardiment?", s: "Colossiens 3:23 - Tout ce que vous faites, faites-le de bon c≈ìur." },
          { q: "Si vous aviez un talent √† utiliser pour Dieu, ce serait lequel?", s: "1 Pierre 4:10 - Que chacun de vous mette au service des autres le don qu'il a re√ßu." }
        ],
        departments: {
          "Administration": { desc: "Personnes organis√©es, soucieuses du d√©tail et fiables qui excellent dans la planification, la coordination et assurent le bon d√©roulement des op√©rations.", scripture: "1 Corinthiens 14:40 - 'Mais que tout se passe dans l'ordre.'" },
          "D√©partement des Enfants": { desc: "Personnes patientes, nourrici√®res et joyeuses qui aiment enseigner, encourager et inspirer les enfants √† grandir dans la foi.", scripture: "Matthieu 19:14 - 'Laissez les petits enfants, et ne les emp√™chez pas de venir √† moi; car le royaume des cieux est pour ceux qui leur ressemblent.'" },
          "Design": { desc: "Personnes innovantes et artistiques qui donnent vie visuellement aux id√©es, utilisant la cr√©ativit√© pour communiquer des messages avec excellence.", scripture: "Exode 35:35 - 'Il les a remplis d'intelligence, pour ex√©cuter tous les ouvrages.'" },
          "Drame": { desc: "Personnes expressives, imaginatives et audacieuses qui utilisent la narration et la performance pour communiquer l'√©vangile de mani√®re puissante.", scripture: "Matthieu 13:34 - 'J√©sus parla en paraboles, et il ne leur parlait point sans parabole.'" },
          "Hospitalit√©": { desc: "Personnes chaleures, accueillantes et attentionn√©es qui cr√©ent une atmosph√®re d'amour et de confort pour tous ceux qu'elles servent.", scripture: "1 Pierre 4:9 - 'Exercez l'hospitalit√© les uns envers les autres sans murmures.'" },
          "√âquipe d'Accueil": { desc: "Personnes amicales, abordables et ax√©es sur le service qui font que chacun se sent vu, valoris√© et comme √† la maison.", scripture: "Romains 15:7 - 'Accueillez-vous donc les uns les autres, comme Christ vous a accueillis, pour la gloire de Dieu.'" },
          "Production": { desc: "Personnes diligentes et soucieuses du d√©tail qui assurent le bon d√©roulement des services gr√¢ce √† l'excellence technique et au soutien en coulisses.", scripture: "Colossiens 3:23 - 'Tout ce que vous faites, faites-le de bon c≈ìur, comme pour le Seigneur.'" },
          "Musique": { desc: "Personnes passionn√©es, comp√©tentes et remplies de l'Esprit qui utilisent leurs dons pour conduire les autres dans l'adoration et la pr√©sence de Dieu.", scripture: "Psaume 95:1-2 - 'Venez, chantons avec all√©gresse √† l'√âternel! Poussons des cris de joie vers le rocher de notre salut. Allons au-devant de lui avec des louanges.'" },
          "Suivi": { desc: "Personnes attentionn√©es, attentives et relationnelles qui aiment guider les nouveaux croyants, √©tablir la confiance et encourager la croissance spirituelle.", scripture: "Matthieu 28:19 - 'Allez, faites de toutes les nations des disciples.'" },
          "Nouveaux Croyants": { desc: "Personnes patientes, solidaires et mentorales qui aident les autres √† comprendre la faith et √† grandir spirituellement.", scripture: "Colossiens 1:28 - 'C'est lui que nous annon√ßons, exhortant tout homme, et instruisant tout homme en toute sagesse.'" },
          "√âvang√©lisation": { desc: "Personnes audacieuses, extraverties et confiantes qui aiment partager l'√©vangile et s'engager avec compassion et courage.", scripture: "Marc 16:15 - 'Allez dans tout le monde, et pr√™chez la bonne nouvelle √† toute la cr√©ation.'" },
          "Gardiens du Sanctuaire": { desc: "Personnes responsables, consciencieuses et soucieuses du d√©tail qui sont fi√®res de maintenir un environnement de culte propre et ordonn√©.", scripture: "1 Corinthiens 3:16 - 'Ne savez-vous pas que vous √™tes le temple de Dieu, et que l'Esprit de Dieu habite en vous?'" },
          "Installation": { desc: "Personnes pratiques, manuelles et orient√©es vers les solutions qui aiment pr√©parer les espaces, g√©rer la logistique et r√©soudre les probl√®mes.", scripture: "N√©h√©mie 4:6 - 'Nous reb√¢t√Æmes la muraille, qui fut partout achev√©e jusqu'√† la moiti√© de sa hauteur.'" },
          "M√©dias Sociaux": { desc: "Personnalit√©s cr√©atives, technophiles et communicatives qui aiment raconter des histoires et engager les communaut√©s en ligne.", scripture: "Psaume 19:14 - 'Que les paroles de ma bouche et la m√©ditation de my c≈ìur soient agr√©ables devant toi.'" },
          "Son": { desc: "Personnes techniquement dou√©es, attentives et pr√©cises qui excellent dans la gestion audio et la cr√©ation d'exp√©riences sonores fluides.", scripture: "1 Corinthiens 14:7 - 'Si les objets inanim√©s qui rendent un son ne rendent pas des sons distincts, comment reconna√Ætre ce qui est jou√©?'" },
          "Uniforme": { desc: "Personnes m√©ticuleuses, disciplin√©es et soucieuses du d√©tail qui valorisent la pr√©sentation, la coh√©rence et les normes √©lev√©es.", scripture: "1 Timoth√©e 4:12 - 'Que personne ne m√©prise ta jeunesse; mais sois un mod√®le pour les fid√®les.'" },
          "Huissiers": { desc: "Personnes amicales, abordables et ax√©es sur le service qui aiment guider, aider et prendre soin des gens de mani√®re pratique.", scripture: "H√©breux 13:17 - 'Ob√©issez √† vos conducteurs et ayez pour eux de la d√©f√©rence.'" },
          "Bien-√™tre": { desc: "Personnes compatissantes, empathiques et g√©n√©reuses qui sont motiv√©es √† aider ceux dans le besoin et √† fournir un soutien.", scripture: "Galates 6:2 - 'Portez les fardeaux les uns des autres.'" },
          "S√©curit√©": { desc: "Personnes vigilantes, responsables et protectrices qui priorisent la s√©curit√© et assurent un environnement s√©curis√© pour les autres.", scripture: "Proverbes 27:12 - 'L'homme prudent voit le mal et se cache; Les simples avancent et sont punis.'" },
          "M√©dias": { desc: "Personnes cr√©atives et technophiles qui capturent, con√ßoivent et partagent du contenu qui diffuse le message avec clart√© et excellence, rendant la vision visible √† tous.", scripture: "Habacuc 2:2 - '√âcris la vision, Grave-la sur des tables.'" },
          "Parole Parl√©e": { desc: "Personnes expressives et cr√©atives qui utilisent la po√©sie, la parole parl√©e ou l'art performatif pour inspirer et communiquer l'√©vangile avec √©motion et impact.", scripture: "Psaume 19:14 - 'Que les paroles de ma bouche et la m√©ditation de mon c≈ìur soient agr√©ables devant toi.'" }
        }
      },
      es: {
        title: "Descubre Tu Departamento en Kharis",
        subtitle: "Responde algunas preguntas para ver d√≥nde encajan mejor tus dones.",
        namePlaceholder: "Ingresa tu nombre completo",
        branchPlaceholder: "Selecciona tu sucursal",
        startButton: "Comenzar Quiz",
        questionCounter: "Pregunta {current} de {total}",
        nextButton: "Siguiente",
        backButton: "‚Üê Atr√°s",
        resultsTitle: "{name} ({branch}) ‚Äî Tus Departamentos Principales",
        exploreButton: "Explorar Todos los Departamentos",
        restartButton: "Comenzar de Nuevo",
        allDepartments: "Todos los Departamentos",
        backToResults: "Volver a Resultados",
        errorMsg: "Por favor escribe algo para que podamos entender üòä",
        noResults: "No se registraron puntajes de departamento, pero no te preocupes. Intenta nuevamente y agrega algunas palabras clave en tus respuestas (por ejemplo, \"Me encanta cantar\", \"Me gusta planificar eventos\").",
        questions: [
          { q: "Cuando te enfrentas al caos, ¬øqu√© te da m√°s estabilidad?", s: "1 Corintios 14:33 ‚Äì Porque Dios no es Dios de confusi√≥n, sino de paz." },
          { q: "¬øC√≥mo prefieres impactar a los dem√°s?", s: "Mateo 5:16 ‚Äì As√≠ alumbre vuestra luz delante de los hombres." },
          { q: "En un grupo, eres el que...", s: "Romanos 12:6 ‚Äì Tenemos dones diferentes, seg√∫n la gracia que nos es dada." },
          { q: "¬øQu√© parte de un servicio notas naturalmente primero?", s: "Efesios 6:7 ‚Äì Sirviendo de buena voluntad, como al Se√±or y no a los hombres." },
          { q: "Si pudieras liderar algo, ¬øqu√© ser√≠a?", s: "Josu√© 1:9 ‚Äì Esfu√©rzate y s√© valiente." },
          { q: "Cuando alguien est√° sufriendo, ¬øqu√© haces naturalmente?", s: "2 Corintios 1:4 ‚Äì Dios nos consuela... para que podamos consolar a otros." },
          { q: "¬øQu√© te emociona m√°s: crear, organizar, ayudar o compartir con valent√≠a?", s: "Colosenses 3:23 ‚Äì Todo lo que hag√°is, hacedlo de coraz√≥n." },
          { q: "Si tuvieras un talento para usar para Dios, ¬øcu√°l ser√≠a?", s: "1 Pedro 4:10 ‚Äì Cada uno seg√∫n el don que ha recibido, min√≠strelo a los otros." }
        ],
        departments: {
          "Administraci√≥n": { desc: "Personas organizadas, detallistas y confiables que sobresalen en planificaci√≥n, coordinaci√≥n y garantizan operaciones fluidas.", scripture: "1 Corintios 14:40 - 'Pero h√°gase todo decentemente y con orden.'" },
          "Departamento Infantil": { desc: "Personas pacientes, nurturing y alegres que aman ense√±ar, animar e inspirar a los ni√±os a crecer en la fe.", scripture: "Mateo 19:14 - 'Dejad a los ni√±os venir a m√≠, y no se lo impid√°is; porque de los tales es el reino de los cielos.'" },
          "Dise√±o": { desc: "Personas innovadoras y art√≠sticas que dan vida visualmente a las ideas, utilizando la creatividad para comunicar mensajes con excelencia.", scripture: "√âxodo 35:35 - 'Los ha llenado de sabidur√≠a de coraz√≥n para que hagan toda obra de arte.'" },
          "Drama": { desc: "Personas expresivas, imaginativas y audaces que utilizan la narraci√≥n de historias y la performance para comunicar el evangelio de manera poderosa.", scripture: "Mateo 13:34 - 'Todo esto habl√≥ Jes√∫s por par√°bolas a la gente, y sin par√°bolas no les hablaba.'" },
          "Hospitalidad": { desc: "Personas c√°lidas, acogedoras y atentas que crean una atm√≥sfera de amor y confort para todos los que sirven.", scripture: "1 Pedro 4:9 - 'Sed hospitalarios los unos con los otros sin murmuraciones.'" },
          "Equipo de Anfitriones": { desc: "Personas amigables, accesibles y orientadas al servicio que hacen que todos se sientan vistos, valorados y como en casa.", scripture: "Romanos 15:7 - 'Por tanto, recib√≠os los unos a los otros, como tambi√©n Cristo nos recibi√≥, para gloria de Dios.'" },
          "Producci√≥n": { desc: "Personas diligentes y detallistas que aseguran el buen funcionamiento de los servicios mediante la excelencia t√©cnica y el apoyo detr√°s de escena.", scripture: "Colosenses 3:23 - 'Y todo lo que hag√°is, hacedlo de coraz√≥n, como para el Se√±or y no para los hombres.'" },
          "M√∫sica": { desc: "Personas apasionadas, talentosas y llenas del Esp√≠ritu que utilizan sus dones para guiar a otros en la adoraci√≥n y la presencia de Dios.", scripture: "Salmos 95:1-2 - 'Venid, aclamemos alegremente a Jehov√°; Cantemos con j√∫bilo a la roca de nuestra salvaci√≥n. Lleguemos ante su presencia con alabanza; Aclam√©mosle con c√°nticos.'" },
          "Seguimiento": { desc: "Personas atentas, cuidadosas y relacionales que disfrutan guiando a nuevos creyentes, construyendo confianza y alentando el crecimiento espiritual.", scripture: "Mateo 28:19 - 'Por tanto, id, y haced disc√≠pulos a todas las naciones.'" },
          "Nuevos Creyentes": { desc: "Personas pacientes, solidarias y con mentalidad de mentor√≠a que aman ayudar a otros a comprender la fe y crecer espiritualmente.", scripture: "Colosenses 1:28 - 'A quien anunciamos, amonestando a todo hombre, y ense√±ando a todo hombre en toda sabidur√≠a.'" },
          "Evangelismo": { desc: "Personas audaces, extrovertidas y seguras que aman compartir el evangelio y relacionarse con otros con compasi√≥n y coraje.", scripture: "Marcos 16:15 - 'Y les dijo: Id por todo el mundo y predicad el evangelio a toda criatura.'" },
          "Guardianes del Santuario": { desc: "Personas responsables, concienzudas y enfocadas en los detalles que se enorgullecen de mantener un ambiente de adoraci√≥n limpio y ordenado.", scripture: "1 Corintios 3:16 - '¬øNo sab√©is que sois templo de Dios, y que el Esp√≠ritu de Dios mora en vosotros?'" },
          "Preparaci√≥n": { desc: "Personas pr√°cticas, manuales y orientadas a soluciones que disfrutan preparando espacios, gestionando log√≠stica y resolviendo problemas.", scripture: "Nehem√≠as 4:6 - 'Edificamos, pues, el muro, y toda la muralla fue terminada hasta la mitad de su altura.'" },
          "Redes Sociales": { desc: "Personalidades creativas, conocedoras de la tecnolog√≠a y comunicativas que disfrutan contar historias y involucrar comunidades en l√≠nea.", scripture: "Salmos 19:14 - 'Sean gratos los dichos de mi boca y la meditaci√≥n de mi coraz√≥n delante de ti.'" },
          "Sonido": { desc: "Personas t√©cnicas, atentas y precisas que prosperan gestionando audio y creando experiencias sonoras fluidas.", scripture: "1 Corintios 14:7 - 'Si los instrumentos musicales no emiten sonidos distintos, ¬øc√≥mo se sabr√° lo que se toca?'" },
          "Uniforme": { desc: "Personas meticulosas, disciplinadas y detallistas que valoran la presentaci√≥n, consistencia y altos est√°ndares.", scripture: "1 Timoteo 4:12 - 'Ninguno tenga en poco tu juventud, sino s√© ejemplo de los creyentes en palabra, conducta, amor, esp√≠ritu, fe y pureza.'" },
          "Ujieres": { desc: "Personas amigables, accesibles y orientadas al servicio que disfrutan guiando, ayudando y cuidando a las personas de manera pr√°ctica.", scripture: "Hebreos 13:17 - 'Obedeced a vuestros pastores, y sujetaos a ellos.'" },
          "Bienestar": { desc: "Personas compasivas, emp√°ticas y generosas que est√°n motivadas a ayudar a los necesitados y brindar apoyo.", scripture: "G√°latas 6:2 - 'Sobrellevad los unos las cargas de los otros.'" },
          "Seguridad": { desc: "Personas alertas, responsables y protectoras que priorizan la seguridad y aseguran un ambiente seguro para los dem√°s.", scripture: "Proverbios 27:12 - 'El avisado ve el mal y se esconde; Mas los simples pasan y reciben el da√±o.'" },
          "Medios": { desc: "Personas creativas y conocedoras de la tecnolog√≠a que capturan, dise√±an y comparten contenido que difunde el mensaje con claridad y excelencia, haciendo visible la visi√≥n para todos.", scripture: "Habacuc 2:2 - 'Escribe la visi√≥n, y decl√°rala en tablas.'" },
          "Palabra Hablada": { desc: "Personas expresivas y creativas que utilizan poes√≠a, palabra hablada o arte performativo para inspirar y comunicar el evangelio con emoci√≥n e impacto.", scripture: "Salmos 19:14 - 'Sean gratos los dichos de mi boca y la meditaci√≥n de mi coraz√≥n delante de ti.'" }
        }
      }
      // Additional languages would follow the same pattern
    };

    /* --------------- DOM refs ------------------ */
    const startScreenEl = document.getElementById('start-screen');
    const quizEl = document.getElementById('quiz');
    const resultEl = document.getElementById('result');
    const backBtn = document.getElementById('back-btn');
    const progressBar = document.getElementById('progress');
    const usernameInput = document.getElementById('username');
    const branchSelect = document.getElementById('branch');
    const modeBtn = document.getElementById('modeBtn');
    const languageSelect = document.getElementById('languageSelect');

    /* --------------- State ------------------ */
    let username = "";
    let branch = "";
    let currentQ = 0;
    let questionHistory = [];
    let currentLanguage = 'en';
    let deptScores = {};
    let lastResultHtml = "";
    let lastSorted = [];

    /* --------------- Initialize ------------------ */
    function init() {
      initSlideshow();
      setLanguage('en');
      
      // Set up event listeners
      document.getElementById('start-kharis').addEventListener('click', startQuiz);
      backBtn.addEventListener('click', goBack);
      modeBtn.addEventListener('click', toggleMode);
      languageSelect.addEventListener('change', handleLanguageChange);
    }

    /* --------------- Language functions ------------------ */
    function setLanguage(langCode) {
      currentLanguage = langCode;
      const lang = translations[langCode] || translations.en;
      
      // Update UI text
      document.getElementById('pageTitle').textContent = lang.title;
      document.getElementById('pageSubtitle').textContent = lang.subtitle;
      document.getElementById('username').placeholder = lang.namePlaceholder;
      document.querySelector('#branch option[disabled]').textContent = lang.branchPlaceholder;
      document.getElementById('start-kharis').textContent = lang.startButton;
      
      // Update back button if visible
      if (backBtn.style.display !== 'none') {
        backBtn.textContent = lang.backButton;
      }
      
      // Update quiz if active
      if (quizEl.classList.contains('show')) {
        showQuestion();
      }
      
      // Update results if active
      if (resultEl.classList.contains('show')) {
        showResult();
      }
      
      // Set the language attribute
      document.documentElement.lang = langCode;
    }

    function handleLanguageChange() {
      setLanguage(this.value);
    }

    /* --------------- Quiz functions ------------------ */
    function startQuiz() {
      username = (usernameInput.value || '').trim();
      branch = (branchSelect.value || '').trim();
      
      if(!username){
        alert("Please enter your full name üòä");
        return;
      }
      if(!branch){
        alert("Please select your branch üòä");
        return;
      }

      currentQ = 0;
      questionHistory = [];
      deptScores = {};
      showQuestion();
    }

    function showQuestion(){
      const lang = translations[currentLanguage] || translations.en;
      const qObj = lang.questions[currentQ];

      quizEl.innerHTML = `
        <div class="question-counter">${lang.questionCounter.replace('{current}', currentQ+1).replace('{total}', lang.questions.length)}</div>
        <div class="scripture">${qObj.s}</div>
        <div class="question">${qObj.q}</div>
        <input id="answer" type="text" placeholder="Type your answer here..." aria-label="Your answer" />
        <div id="error-msg" style="color:#ffd700;font-weight:600;text-align:center;margin-bottom:10px;"></div>
        <button class="btn" id="nextBtn">${lang.nextButton}</button>
      `;

      quizEl.classList.add('show');
      startScreenEl.style.display = "none";
      resultEl.classList.remove('show');
      backBtn.style.display = currentQ > 0 ? "inline-block" : "none";
      backBtn.textContent = lang.backButton;
      progressBar.style.width = Math.round(((currentQ+1)/lang.questions.length)*100) + "%";

      // Add event listeners
      setTimeout(() => {
        const nextBtn = document.getElementById('nextBtn');
        if (nextBtn) nextBtn.addEventListener('click', nextQuestion);
        
        const answerInput = document.getElementById('answer');
        if (answerInput) answerInput.focus();
      }, 20);
    }

    function nextQuestion(){
      const inputEl = document.getElementById('answer');
      const value = inputEl ? inputEl.value.trim() : '';
      const lang = translations[currentLanguage] || translations.en;

      if (!value) {
        document.getElementById('error-msg').textContent = lang.errorMsg;
        return;
      }

      // Save snapshot for back
      questionHistory.push({ 
        q: currentQ,
        deptScores: {...deptScores}
      });
      
      // Score the answer (simplified for demo)
      scoreAnswer(value);
      
      currentQ++;
      const langData = translations[currentLanguage] || translations.en;

      if (currentQ < langData.questions.length) {
        showQuestion();
      } else {
        showResult();
      }
    }

    function scoreAnswer(input) {
      // Simplified scoring for demo - in a real implementation, this would
      // analyze the text and assign scores to departments
      const text = input.toLowerCase();
      
      // Just for demo purposes, assign some scores
      if (text.includes('music') || text.includes('sing') || text.includes('worship')) {
        deptScores['Music'] = (deptScores['Music'] || 0) + 2;
      }
      if (text.includes('child') || text.includes('kid') || text.includes('teach')) {
        deptScores["Children's Department"] = (deptScores["Children's Department"] || 0) + 2;
      }
      if (text.includes('help') || text.includes('serve') || text.includes('care')) {
        deptScores['Hospitality'] = (deptScores['Hospitality'] || 0) + 2;
        deptScores['Welfare'] = (deptScores['Welfare'] || 0) + 1;
      }
      if (text.includes('organiz') || text.includes('plan') || text.includes('admin')) {
        deptScores['Administration'] = (deptScores['Administration'] || 0) + 2;
      }
      
      // Ensure all departments have at least some score
      const lang = translations[currentLanguage] || translations.en;
      Object.keys(lang.departments).forEach(dept => {
        deptScores[dept] = deptScores[dept] || Math.random() * 0.5;
      });
    }

    function goBack() {
      if(questionHistory.length === 0) return;
      const last = questionHistory.pop();
      currentQ = last.q;
      deptScores = last.deptScores;
      showQuestion();
    }

    function showResult(){
      quizEl.classList.remove('show');
      resultEl.classList.add('show');
      backBtn.style.display = "none";

      const lang = translations[currentLanguage] || translations.en;

      // Get top departments based on scores
      const sorted = Object.entries(deptScores).sort((a, b) => b[1] - a[1]);
      const topDepts = sorted.slice(0, 2);
      lastSorted = topDepts;

      // Build result HTML
      let html = `<h2>${lang.resultsTitle.replace('{name}', username).replace('{branch}', branch)}</h2>`;

      if(topDepts.length === 0){
        html += `<div class="result"><p>${lang.noResults}</p></div>`;
      } else {
        html += `<div class="result">`;
        topDepts.forEach((entry, idx) => {
          const dept = entry[0];
          const deptInfo = lang.departments[dept] || {desc: "Department information", scripture: "Scripture reference"};
          html += `
            <div class="department" id="dept-${idx}">
              <strong>${dept}</strong>
              <div class="scripture-box" id="scripture-${idx}">
                <p>${deptInfo.desc}</p>
                <p><strong>Scripture:</strong> ${deptInfo.scripture}</p>
              </div>
            </div>
          `;
        });
        html += `</div>`;
      }

      html += `
        <div style="margin-top:16px;">
          <button class="btn" id="explore-all-btn">${lang.exploreButton}</button>
          <button class="btn" id="restart-btn" style="background:transparent;color:var(--btn-bg);border:2px solid var(--btn-bg);">${lang.restartButton}</button>
        </div>
      `;

      resultEl.innerHTML = html;
      lastResultHtml = html;

      // Show with small animation
      setTimeout(() => {
        topDepts.forEach((_, i) => {
          const el = document.getElementById(`dept-${i}`);
          const sb = document.getElementById(`scripture-${i}`);
          if(el){
            setTimeout(() => {
              el.classList.add('show');
              sb.classList.add('visible');
            }, i * 350);
          }
        });
      }, 100);

      // Attach listeners
      document.getElementById('explore-all-btn').addEventListener('click', renderExploreList);
      document.getElementById('restart-btn').addEventListener('click', restartWithoutReload);
    }

    function renderExploreList(){
      const lang = translations[currentLanguage] || translations.en;
      
      let html = `<h2>${lang.allDepartments}</h2><div class="explore-list">`;
      
      // Add all departments
      Object.entries(lang.departments).forEach(([dept, info], idx) => {
        html += `
          <div class="explore-item" data-idx="${idx}">
            <div class="title">${dept}</div>
            <div style="margin-left:12px;font-weight:600;color:var(--btn-bg);">+</div>
            <div class="explore-details" id="explore-detail-${idx}">
              <p style="margin:0 0 6px 0">${info.desc}</p>
              <p style="margin:0;font-style:italic;font-size:0.95rem">${info.scripture}</p>
            </div>
          </div>
        `;
      });
      
      html += `</div><div style="margin-top:14px;"><button class="btn" id="back-to-result">${lang.backToResults}</button></div>`;

      resultEl.innerHTML = html;

      // Attach toggle listeners
      const items = resultEl.querySelectorAll('.explore-item');
      items.forEach((it) => {
        const idx = it.getAttribute('data-idx');
        const details = resultEl.querySelector(`#explore-detail-${idx}`);
        details.style.display = 'none';
        
        it.addEventListener('click', () => {
          const isVisible = details.style.display === 'block';
          details.style.display = isVisible ? 'none' : 'block';
        });
      });

      // Back button handler
      document.getElementById('back-to-result').addEventListener('click', () => {
        resultEl.innerHTML = lastResultHtml;
        document.getElementById('explore-all-btn').addEventListener('click', renderExploreList);
        document.getElementById('restart-btn').addEventListener('click', restartWithoutReload);
        
        // Re-animate departments
        setTimeout(() => {
          lastSorted.forEach((_, i) => {
            const el = document.getElementById(`dept-${i}`);
            const sb = document.getElementById(`scripture-${i}`);
            if(el){
              el.classList.add('show');
              sb.classList.add('visible');
            }
          });
        }, 100);
      });
    }

    function restartWithoutReload(){
      currentQ = 0;
      questionHistory = [];
      deptScores = {};
      startScreenEl.style.display = "block";
      quizEl.classList.remove('show');
      resultEl.classList.remove('show');
      progressBar.style.width = "0%";
      backBtn.style.display = "none";
    }

    function toggleMode() {
      document.body.classList.toggle('light');
      modeBtn.textContent = document.body.classList.contains('light') ? '‚òÄÔ∏è' : 'üåô';
    }

    // Initialize the application
    init();
  })();
  </script>
</body>
</html>
